---
tags:
  - 面试
  - 问答
by: "[[AI-豆包]]"
---
# 项目二（MySQL 高可用集群）HR / 技术面试官高频问题及回答思路
**自动化集群环境初始化 + MySQL 高可用集群搭建与灾备设计 + 高可用架构强化与监控可视化实现**
> （注：文档部分内容可能由 AI 生成）
### 自动化集群环境初始化：
- 基于 Linux 系统环境，运用 Ansible 自动化工具编写 Playbook 脚本，
- 通过配置跨节点 SSH 免密登录（基于 RSA 密钥认证），
	- 实现 3 台服务器（1 主 2 从）的集群环境一键初始化，
	- 包括系统依赖安装（如 libaio、perl）、内核参数优化（调整 sysctl.conf 中 net.ipv4.tcp_syncookies 等参数）、防火墙规则配置（开放 3306、22 **端口**），
- 替代传统手动操作，将集群部署时间从原计划 4 小时缩短至 30 分钟，
- 同时保障环境配置一致性，避免因人工操作差异导致的部署故障。
### MySQL 高可用集群搭建与灾备设计：
- 搭建单 master + 双 slave MySQL 集群，
- 启用半同步复制机制（配置 plugin-load-add=rpl_semi_sync_master.so 等参数）与 GTID（全局事务标识），
	- 确保主从节点数据同步的可靠性与一致性，解决传统异步复制易出现的数据丢失问题；
- 设计 “实时备份 + 延迟备份” 双层灾备方案：
	- 通过 rsync+sersync 工具实现 master 节点数据实时同步至备份服务器，
	- 同时在 slave 节点配置 30 分钟延迟复制，应对误操作导致的数据损坏场景；
- 借助 MySQL Router 配置读写分离规则，
	- 将查询请求分流至 slave 节点，缓解 master 节点访问压力，核心 SQL 查询响应时间从 1.2 秒优化至 0.5 秒。
### 高可用架构强化与监控可视化实现：
- 在 2 台 MySQL Router 节点部署 Keepalived 服务，
- 配置双 VIP（虚拟 IP）互为主备模式，通过 VRRP 协议实现 VIP 自动漂移，
	- 当主 Router 节点故障时，备用节点可在 10 秒内接管服务，保障读写分离架构不中断；
- 集成 Prometheus+Grafana 监控体系，编写自定义 Exporter 脚本（基于 Python），采集 MySQL 主从同步延迟、连接数、QPS（每秒查询率）及 Router 节点负载等核心指标，
	- 搭建可视化监控面板，实现异常指标实时告警（如同步延迟超过 30 秒时触发邮件通知）；
- 使用 sysbench 工具进行压力测试（模拟 1000 并发用户、10 万条测试数据），
	- 验证集群读写性能较单节点 MySQL 提升 45%，
	- 且在单 slave 节点下线场景下，服务仍能稳定运行，可用性达 99.9%。
## 一、基础认知类（HR / 初级技术岗常问，侧重 “做了什么”）

- **问题 1：**
	1. 这个 MySQL 集群项目是你独立做的吗？
	2. 主要负责哪些环节？
- **问题 2：**
	- 为什么选择 “1 主 2 从” 的集群架构？而不是 2 主或其他模式？
### 问题 1 回答 ：
是我独立负责的个人实践项目，从前期方案设计到后期落地运维全流程跟进。
**核心负责 3 块：**
1. 用 [[Ansible]] 做集群环境初始化，解决手动部署效率低、配置不一致的问题；
2. 搭建 “1 主 2 从” [[MySQL]] 架构，做读写分离和高可用保障；
3. 设计数据备份方案 + 集成监控，确保数据安全和服务稳定。

整个过程没依赖外部技术支持，遇到的比如 “主从同步延迟” 问题，也是**查文档**后通过调整复制参数解决的。
### 问题 2 回答 ：
**主要考虑两个点：**
1. 我的项目场景是 **“中小规模数据读写”**，**1 主**足够承载写请求，**2 从**能分流读压力，架构不冗余且成本可控（用 3 台轻量服务器就能实现）；
2. **维护复杂度低**：如果选 2 主模式，需要处理 “双主互备” 的冲突问题（比如同一条数据同时修改），对初期实践来说门槛太高。
	- “1 主 2 从” 既能满足高可用（1 从故障还有另 1 从兜底），又能平衡性能和维护成本，更贴合我的实践目标。

## 二、技术落地类（中级技术岗常问，侧重 “怎么做 + 解决什么问题”）

 - **问题 3：**
	 1. 用 Ansible 初始化集群时，具体做了哪些操作？
	 2. 相比手动部署有什么优势？
- **问题 4：**
	1. 怎么保证 MySQL 主从数据一致？
	2. 如果出现同步延迟怎么处理？
- **问题 5：**
	1. Keepalived 是怎么配合 MySQL Router 实现高可用的？
	2. 如果其中一个 Router 挂了会怎么样？
### 问题 3 回答：
**Ansible 部分主要写了 Playbook 脚本，核心操作有 3 个：**
1. 配置跨节点 SSH 免密登录，不用每次部署输密码；
2. 批量安装系统依赖（比如 MySQL 需要的 libaio 库、perl 工具），并优化内核参数（比如调整 TCP 连接数、内存缓存）；
3. 统一配置防火墙，只开放 3306（MySQL 端口）和 22（SSH 端口），避免无用端口暴露。

**优势很明显：**
- 手动部署 3 台服务器至少要 4 小时，还容易漏装依赖或配错参数；
- 用 Ansible 后 30 分钟就能完成，且 3 台配置完全一致，后续改参数也能批量执行，省了很多重复工作。
### 问题 4 回答 ：
**我主要做了两方面保障一致性：**
1. 启用 “半同步复制”，主库要等至少 1 个从库确认收到日志才返回成功，避免主库宕机后从库丢数据；
2. 开了 GTID（全局事务标识），每个事务有唯一 ID，从库不会重复执行，也不用手动找同步位点，出问题后恢复更快。

**遇到过一次同步延迟（大概 20 秒）：**
- 查日志发现是从库同时跑了备份脚本，CPU 占用太高；
- 调整了备份时间，和业务低峰期错开；
- 把从库的 “并行复制” 参数调大了，让从库能多线程处理事务，之后延迟基本控制在 1 秒内。

### 问题 5 回答 ：
我在 2 台 Router 节点上都装了 Keepalived，配置了两个虚拟 IP（VIP），互为主备 —— 比如 Router1 默认绑定 VIP1（供读请求用），Router2 绑定 VIP2（供写请求用），同时互相监测对方状态。
- 如果 Router1 挂了，Keepalived 会在 10 秒内检测到，自动把 VIP1 切换到 Router2 上；
- 反过来如果 Router2 挂了，VIP2 会切到 Router1 上。
- 业务侧不用改任何配置，还是连原来的 VIP，完全感知不到故障，这样读写分离架构就不会中断。
- 之前做过故障演练，手动停掉一个 Router，服务没断，也没丢请求。

## 三、成果与思考类（资深技术岗 / 负责人常问，侧重 “价值 + 复盘”）

- **问题 6：**
	1. 这个集群的性能提升 40% 是怎么测出来的？
	2. 具体体现在哪些场景？
- **问题 7：**
	1. 项目里有没有踩过坑？
	2. 如果再做一次，你会优化哪些地方？

### 问题 6 回答：
用 sysbench 工具测的，模拟了两种场景：
1. “读多写少”（比如 1000 用户同时查数据），
2. “读写混合”（比如 500 人查、500 人写）。
测试前单节点 MySQL 的读响应时间大概 1.2 秒，写是 0.8 秒；
集群搭建后，读响应降到 0.5 秒，写基本稳定在 0.7 秒，整体读写性能提升了 45% 左右（不同场景略有差异）。
实际用的时候，比如批量导数据（一次导 1 万条），单节点要等 1 分钟，集群只用 25 秒，而且导数据的时候，其他查数据的请求也不卡，因为读请求都被分到从库了，主库只负责写，压力小了很多。

### 问题 7 回答：
踩过一个坑：
- 刚开始没考虑数据备份的 “时间窗口”，把备份脚本和业务高峰期（比如晚上 8 点用户发邮件多）凑一块了，导致从库 IO 占用太高，主从同步延迟变大。
- 后来把备份改到凌晨 3 点，还加了 “延迟备份”（从库比主库慢 30 分钟同步），就算主库误删数据，也能从从库恢复 30 分钟前的数据，更安全了。

如果再做一次，我会加两点优化：
1. 用 “容器化” 部署 MySQL 和 Router，现在是直接装在服务器上，迁移起来麻烦；
2. 加个 “自动故障转移” 工具（比如 MHA），现在主库如果挂了，从库切换成主库需要手动改参数，加了 MHA 就能自动切，更省心。

## 四、适配 HR 的 “非技术延伸问”（侧重软技能）

- **问题 8：**
	- 做这个项目遇到技术难点时，怎么解决的？
- **问题 9：**
	- 这个项目对你之后做运维工作有什么帮助？

### 问题 8 回答：
比如刚开始不知道怎么用 Prometheus 监控 MySQL 的 “主从同步延迟”，
- 查了 MySQL 官方文档，发现可以通过 `show slave status` 命令获取延迟值，
- 然后用 Python 写了个简单的 Exporter 脚本，
- 把这个值传给 Prometheus，
- 再在 Grafana 上做图表。

整个过程就是 “先定位问题 → 查官方文档 / 技术社区（比如 Stack Overflow）→ 小步测试（先在本地搭个小集群试脚本）→ 落地到项目”，
遇到不懂的不硬扛，找可靠的资料慢慢啃，最后都能解决。

### 问题 9 回答：
最大的帮助是建立了 “高可用 + 自动化” 的思维 
- 比如以前觉得 “能跑通就行”，
- 现在会主动想 “服务挂了怎么办？数据丢了怎么办？怎么减少手动操作？”
- 比如现在看其他服务，会下意识考虑 “要不要做备份”“要不要加监控”，也更熟悉 Linux、自动化脚本、数据库这些运维核心技能的实际用法，之后接手公司的运维工作，应该能更快上手。
